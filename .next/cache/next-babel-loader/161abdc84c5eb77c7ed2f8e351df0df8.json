{"ast":null,"code":"var __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Component } from 'react';\nimport axios from 'axios';\nimport Pusher from 'pusher-js';\nimport Comment from '../Comment/Comment';\nconst SAD_EMOJI = [55357, 56864];\nconst HAPPY_EMOJI = [55357, 56832];\nconst NEUTRAL_EMOJI = [55357, 56848];\n\nclass CommentsWidget extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      comments: [],\n      person: null\n    });\n\n    _defineProperty(this, \"handleKeyUp\", evt => {\n      const value = evt.target.value;\n\n      if (evt.keyCode === 13 && !evt.shiftKey) {\n        const {\n          person\n        } = this.state;\n        const comment = {\n          person,\n          comment: value,\n          timestamp: +new Date()\n        };\n        evt.target.value = '';\n        this.setState({\n          person: null\n        }, () => axios.post('/comment', comment));\n      }\n    });\n  }\n\n  componentDidMount() {\n    this.pusher = new Pusher(process.env.PUSHER_APP_KEY, {\n      cluster: process.env.PUSHER_APP_CLUSTER,\n      encrypted: true\n    });\n    this.channel = this.pusher.subscribe('post-comments');\n    this.channel.bind('new-comment', ({\n      comment = null\n    }) => {\n      const {\n        comments\n      } = this.state;\n      comment && comments.push(comment);\n      this.setState({\n        comments\n      });\n    });\n    this.pusher.connection.bind('connected', () => {\n      axios.post('/comments').then(response => {\n        const comments = response.data.comments;\n        this.setState({\n          comments\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    this.pusher.disconnect();\n  }\n\n  render() {\n    const people = ['Stephanie', 'John', 'Steve', 'Anna', 'Margaret', 'Felix', 'Chris', 'Jamie', 'Rose', 'Bob', 'Vanessa', '9lad', 'Bridget', 'Sebastian', 'Richard'];\n    const nameBadgeStyles = {\n      fontSize: '0.8rem',\n      height: 40,\n      borderRadius: 20,\n      cursor: 'pointer'\n    };\n\n    const choosePersona = person => evt => this.setState({\n      person\n    });\n\n    const randomPeople = count => {\n      const selected = [];\n      let i = 0;\n      count = Math.max(0, Math.min(count, people.length));\n\n      while (i < count) {\n        const index = Math.floor(Math.random() * people.length);\n        if (selected.includes(index)) continue;\n        ++i && selected.push(index);\n      }\n\n      return selected.map(index => {\n        const person = people[index];\n        const className = 'd-block d-flex align-items-center text-center text-white bg-secondary font-weight-bold py-2 px-4 mr-3';\n        return __jsx(\"span\", {\n          key: index,\n          className: className,\n          style: nameBadgeStyles,\n          title: person,\n          onClick: choosePersona(person)\n        }, person);\n      });\n    };\n\n    return __jsx(React.Fragment, null, __jsx(\"div\", {\n      className: \"border-bottom border-gray w-100 px-2 d-flex align-items-center bg-white justify-content-between\",\n      style: {\n        height: 90\n      }\n    }, __jsx(\"h2\", {\n      className: \"text-dark mb-0 mx-4\"\n    }, \"Comments\"), __jsx(\"span\", {\n      className: \"badge badge-pill badge-primary mx-4\",\n      style: {\n        fontSize: '1.2rem'\n      }\n    }, this.state.comments.length)), __jsx(\"div\", {\n      className: \"px-4 pb-4 w-100 d-flex flex-row flex-wrap align-items-start align-content-start position-relative\",\n      style: {\n        height: 'calc(100% - 250px)',\n        overflowY: 'scroll'\n      }\n    }, this.state.comments.map((comment, index) => {\n      const mood = comment.sentiment > 0 ? HAPPY_EMOJI : comment.sentiment === 0 ? NEUTRAL_EMOJI : SAD_EMOJI;\n      return __jsx(Fragment, {\n        key: index\n      }, __jsx(\"div\", {\n        className: `d-flex justify-content-start align-items-center w-100 font-weight-bold text-dark mt-4 pb-1 px-1`,\n        style: {\n          fontSize: '0.9rem'\n        }\n      }, __jsx(\"span\", {\n        className: \"d-inline-block pr-1\",\n        style: {\n          fontSize: '1.25rem'\n        }\n      }, String.fromCodePoint(...mood)), __jsx(\"span\", {\n        className: \"align-middle\",\n        style: {\n          lineHeight: '1.25rem'\n        }\n      }, comment.person || 'Anonymous')), __jsx(Comment, {\n        text: comment.comment\n      }));\n    })), __jsx(\"div\", {\n      className: \"border-top border-gray w-100 px-4 d-flex flex-wrap align-items-center align-content-center bg-light\",\n      style: {\n        height: 160\n      }\n    }, !this.state.person && __jsx(\"span\", {\n      className: \"text-dark py-2\",\n      style: {\n        fontSize: '1.5rem',\n        fontWeight: 500\n      }\n    }, \"Choose your Persona\"), __jsx(\"div\", {\n      className: \"w-100 py-2 pb-3 d-flex justify-content-start\"\n    }, this.state.person ? __jsx(\"span\", {\n      className: \"d-block d-flex align-items-center text-center text-white bg-primary font-weight-bold py-2 px-4 mr-3\",\n      style: nameBadgeStyles,\n      title: this.state.person\n    }, this.state.person) : randomPeople(4)), this.state.person && __jsx(\"textarea\", {\n      className: \"form-control px-3 py-2\",\n      onKeyUp: this.handleKeyUp,\n      placeholder: \"Make a comment\",\n      style: {\n        resize: 'none'\n      }\n    })));\n  }\n\n}\n\nexport default CommentsWidget;","map":{"version":3,"sources":["/Users/SissyXia11/Desktop/reacthomework/next-js-app/components/CommentsWidget/CommentsWidget.js"],"names":["React","Component","axios","Pusher","Comment","SAD_EMOJI","HAPPY_EMOJI","NEUTRAL_EMOJI","CommentsWidget","comments","person","evt","value","target","keyCode","shiftKey","state","comment","timestamp","Date","setState","post","componentDidMount","pusher","process","env","PUSHER_APP_KEY","cluster","PUSHER_APP_CLUSTER","encrypted","channel","subscribe","bind","push","connection","then","response","data","catch","error","console","log","componentWillUnmount","disconnect","render","people","nameBadgeStyles","fontSize","height","borderRadius","cursor","choosePersona","randomPeople","count","selected","i","Math","max","min","length","index","floor","random","includes","map","className","overflowY","mood","sentiment","String","fromCodePoint","lineHeight","fontWeight","handleKeyUp","resize"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport axios from 'axios';\nimport Pusher from 'pusher-js';\nimport Comment from '../Comment/Comment';\n\nconst SAD_EMOJI = [55357, 56864];\nconst HAPPY_EMOJI = [55357, 56832];\nconst NEUTRAL_EMOJI = [55357, 56848];\n\nclass CommentsWidget extends Component {\n  state = { comments: [], person: null };\n\n  componentDidMount() {\n    this.pusher = new Pusher(process.env.PUSHER_APP_KEY, {\n      cluster: process.env.PUSHER_APP_CLUSTER,\n      encrypted: true,\n    });\n\n    this.channel = this.pusher.subscribe('post-comments');\n\n    this.channel.bind('new-comment', ({ comment = null }) => {\n      const { comments } = this.state;\n      comment && comments.push(comment);\n      this.setState({ comments });\n    });\n\n    this.pusher.connection.bind('connected', () => {\n      axios\n        .post('/comments')\n        .then((response) => {\n          const comments = response.data.comments;\n          this.setState({ comments });\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    });\n  }\n\n  componentWillUnmount() {\n    this.pusher.disconnect();\n  }\n\n  handleKeyUp = (evt) => {\n    const value = evt.target.value;\n\n    if (evt.keyCode === 13 && !evt.shiftKey) {\n      const { person } = this.state;\n      const comment = { person, comment: value, timestamp: +new Date() };\n\n      evt.target.value = '';\n      this.setState({ person: null }, () => axios.post('/comment', comment));\n    }\n  };\n\n  render() {\n    const people = [\n      'Stephanie',\n      'John',\n      'Steve',\n      'Anna',\n      'Margaret',\n      'Felix',\n      'Chris',\n      'Jamie',\n      'Rose',\n      'Bob',\n      'Vanessa',\n      '9lad',\n      'Bridget',\n      'Sebastian',\n      'Richard',\n    ];\n\n    const nameBadgeStyles = {\n      fontSize: '0.8rem',\n      height: 40,\n      borderRadius: 20,\n      cursor: 'pointer',\n    };\n\n    const choosePersona = (person) => (evt) => this.setState({ person });\n\n    const randomPeople = (count) => {\n      const selected = [];\n      let i = 0;\n\n      count = Math.max(0, Math.min(count, people.length));\n\n      while (i < count) {\n        const index = Math.floor(Math.random() * people.length);\n        if (selected.includes(index)) continue;\n        ++i && selected.push(index);\n      }\n\n      return selected.map((index) => {\n        const person = people[index];\n        const className =\n          'd-block d-flex align-items-center text-center text-white bg-secondary font-weight-bold py-2 px-4 mr-3';\n\n        return (\n          <span\n            key={index}\n            className={className}\n            style={nameBadgeStyles}\n            title={person}\n            onClick={choosePersona(person)}\n          >\n            {person}\n          </span>\n        );\n      });\n    };\n\n    return (\n      <>\n        <div\n          className='border-bottom border-gray w-100 px-2 d-flex align-items-center bg-white justify-content-between'\n          style={{ height: 90 }}\n        >\n          <h2 className='text-dark mb-0 mx-4'>Comments</h2>\n          <span\n            className='badge badge-pill badge-primary mx-4'\n            style={{ fontSize: '1.2rem' }}\n          >\n            {this.state.comments.length}\n          </span>\n        </div>\n\n        <div\n          className='px-4 pb-4 w-100 d-flex flex-row flex-wrap align-items-start align-content-start position-relative'\n          style={{ height: 'calc(100% - 250px)', overflowY: 'scroll' }}\n        >\n          {this.state.comments.map((comment, index) => {\n            const mood =\n              comment.sentiment > 0\n                ? HAPPY_EMOJI\n                : comment.sentiment === 0\n                ? NEUTRAL_EMOJI\n                : SAD_EMOJI;\n\n            return (\n              <Fragment key={index}>\n                <div\n                  className={`d-flex justify-content-start align-items-center w-100 font-weight-bold text-dark mt-4 pb-1 px-1`}\n                  style={{ fontSize: '0.9rem' }}\n                >\n                  <span\n                    className='d-inline-block pr-1'\n                    style={{ fontSize: '1.25rem' }}\n                  >\n                    {String.fromCodePoint(...mood)}\n                  </span>\n                  <span\n                    className='align-middle'\n                    style={{ lineHeight: '1.25rem' }}\n                  >\n                    {comment.person || 'Anonymous'}\n                  </span>\n                </div>\n\n                <Comment text={comment.comment} />\n              </Fragment>\n            );\n          })}\n        </div>\n\n        <div\n          className='border-top border-gray w-100 px-4 d-flex flex-wrap align-items-center align-content-center bg-light'\n          style={{ height: 160 }}\n        >\n          {!this.state.person && (\n            <span\n              className='text-dark py-2'\n              style={{ fontSize: '1.5rem', fontWeight: 500 }}\n            >\n              Choose your Persona\n            </span>\n          )}\n\n          <div className='w-100 py-2 pb-3 d-flex justify-content-start'>\n            {this.state.person ? (\n              <span\n                className='d-block d-flex align-items-center text-center text-white bg-primary font-weight-bold py-2 px-4 mr-3'\n                style={nameBadgeStyles}\n                title={this.state.person}\n              >\n                {this.state.person}\n              </span>\n            ) : (\n              randomPeople(4)\n            )}\n          </div>\n\n          {this.state.person && (\n            <textarea\n              className='form-control px-3 py-2'\n              onKeyUp={this.handleKeyUp}\n              placeholder='Make a comment'\n              style={{ resize: 'none' }}\n            ></textarea>\n          )}\n        </div>\n      </>\n    );\n  }\n}\n\nexport default CommentsWidget;\n"]},"metadata":{},"sourceType":"module"}