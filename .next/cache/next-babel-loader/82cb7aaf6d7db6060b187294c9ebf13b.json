{"ast":null,"code":"var _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { Component, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Pusher from 'pusher-js';\n\nvar CommentsWidget = function CommentsWidget(props) {\n  _s();\n\n  var _useState = useState([]),\n      comment = _useState[0],\n      setComment = _useState[1];\n\n  var _useState2 = useState(null),\n      person = _useState2[0],\n      setPerson = _useState2[1];\n\n  useEffect(function () {\n    _this.pusher = new Pusher(process.env.PUSHER_APP_KEY, {\n      cluster: process.env.PUSHER_APP_CLUSTER,\n      encrypted: true\n    });\n    _this.channel = _this.pusher.subscribe('post-comments');\n\n    _this.channel.bind('new-comment', function (_ref) {\n      var _ref$comment = _ref.comment,\n          comment = _ref$comment === void 0 ? null : _ref$comment;\n\n      var _ref2 = comment && comments.push(comment),\n          comments = _ref2.comments;\n\n      setComment(comments);\n    });\n\n    _this.pusher.connection.bind('connected', function () {\n      axios.post('/comments').then(function (response) {\n        var comments = response.data.comments;\n        setComment(comments);\n      });\n    });\n\n    return function () {\n      return _this.pusher.disconnect();\n    };\n  }, []);\n\n  var handleKeyUp = function handleKeyUp(evt) {\n    var value = evt.target.value;\n\n    if (evt.keyCode === 13 && !evt.shiftKey) {\n      var _person = _this.state.person;\n      var _comment = {\n        person: _person,\n        comment: value,\n        timestamp: +new Date()\n      };\n      evt.target.value = '';\n      setPerson(null, function () {\n        return axios.post('/comment', _comment);\n      });\n    }\n  };\n\n  var people = ['Stephanie', 'John', 'Steve', 'Anna', 'Margaret', 'Felix', 'Chris', 'Jamie', 'Rose', 'Bob', 'Vanessa', '9lad', 'Bridget', 'Sebastian', 'Richard'];\n  var nameBadgeStyles = {\n    fontSize: '0.8rem',\n    height: 40,\n    borderRadius: 20,\n    cursor: 'pointer'\n  };\n\n  var choosePersona = function choosePersona(person) {\n    return function (evt) {\n      return setPerson(person);\n    };\n  };\n\n  var randomPeople = function randomPeople(count) {\n    var selected = [];\n    var i = 0;\n    count = Math.max(0, Math.min(count, people.length));\n\n    while (i < count) {\n      var index = Math.floor(Math.random() * people.length);\n      if (selected.includes(index)) continue;\n      ++i && selected.push(index);\n    }\n\n    return selected.map(function (index) {\n      var person = people[index];\n      var className = 'd-block d-flex align-items-center text-center text-white bg-secondary font-weight-bold py-2 px-4 mr-3';\n      return __jsx(\"span\", {\n        key: index,\n        className: className,\n        style: nameBadgeStyles,\n        title: person,\n        onClick: choosePersona(person)\n      }, person);\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"border-bottom border-gray w-100 px-2 d-flex align-items-center bg-white justify-content-between\",\n    style: {\n      height: 90\n    }\n  }, __jsx(\"h2\", {\n    className: \"text-dark mb-0 mx-4\"\n  }, \"Comments\"), __jsx(\"span\", {\n    \"class\": \"badge badge-pill badge-primary mx-4\",\n    style: {\n      fontSize: '1.2rem'\n    }\n  }, _this.comments.length)), __jsx(\"div\", {\n    className: \"border-top border-gray w-100 px-4 d-flex flex-wrap align-items-center align-content-center bg-light\",\n    style: {\n      height: 160\n    }\n  }, !person && __jsx(\"span\", {\n    className: \"text-dark py-2\",\n    style: {\n      fontSize: '1.5rem',\n      fontWeight: 500\n    }\n  }, \"Choose your Persona\"), __jsx(\"div\", {\n    className: \"w-100 py-2 pb-3 d-flex justify-content-start\"\n  }, person ? __jsx(\"span\", {\n    className: \"d-block d-flex align-items-center text-center text-white bg-primary font-weight-bold py-2 px-4 mr-3\",\n    style: nameBadgeStyles,\n    title: person\n  }, person) : randomPeople(4)), person && __jsx(\"textarea\", {\n    className: \"form-control px-3 py-2\",\n    onKeyUp: handleKeyUp,\n    placeholder: \"Make a comment\",\n    style: {\n      resize: 'none'\n    }\n  })));\n};\n\n_s(CommentsWidget, \"zcA5IRN7ojavkKNkctNqGC/pz3g=\");\n\n_c = CommentsWidget;\nexport default CommentsWidget;\n\nvar _c;\n\n$RefreshReg$(_c, \"CommentsWidget\");","map":{"version":3,"sources":["/Users/SissyXia11/Desktop/reacthomework/next-js-app/components/CommentsWidget/CommentsWidget.js"],"names":["React","Component","useState","useEffect","axios","Pusher","CommentsWidget","props","comment","setComment","person","setPerson","pusher","process","env","PUSHER_APP_KEY","cluster","PUSHER_APP_CLUSTER","encrypted","channel","subscribe","bind","comments","push","connection","post","then","response","data","disconnect","handleKeyUp","evt","value","target","keyCode","shiftKey","state","timestamp","Date","people","nameBadgeStyles","fontSize","height","borderRadius","cursor","choosePersona","randomPeople","count","selected","i","Math","max","min","length","index","floor","random","includes","map","className","fontWeight","resize"],"mappings":";;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,EAAqCC,SAArC,QAAsD,OAAtD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,WAAnB;;AAEA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACC,KAAD,EAAW;AAAA;;AAAA,kBACFL,QAAQ,CAAC,EAAD,CADN;AAAA,MACzBM,OADyB;AAAA,MAChBC,UADgB;;AAAA,mBAEJP,QAAQ,CAAC,IAAD,CAFJ;AAAA,MAEzBQ,MAFyB;AAAA,MAEjBC,SAFiB;;AAIhCR,EAAAA,SAAS,CAAC,YAAM;AACd,IAAA,KAAI,CAACS,MAAL,GAAc,IAAIP,MAAJ,CAAWQ,OAAO,CAACC,GAAR,CAAYC,cAAvB,EAAuC;AACnDC,MAAAA,OAAO,EAAEH,OAAO,CAACC,GAAR,CAAYG,kBAD8B;AAEnDC,MAAAA,SAAS,EAAE;AAFwC,KAAvC,CAAd;AAIA,IAAA,KAAI,CAACC,OAAL,GAAe,KAAI,CAACP,MAAL,CAAYQ,SAAZ,CAAsB,eAAtB,CAAf;;AAEA,IAAA,KAAI,CAACD,OAAL,CAAaE,IAAb,CAAkB,aAAlB,EAAiC,gBAAwB;AAAA,8BAArBb,OAAqB;AAAA,UAArBA,OAAqB,6BAAX,IAAW;;AAAA,kBAClCA,OAAO,IAAIc,QAAQ,CAACC,IAAT,CAAcf,OAAd,CADuB;AAAA,UAC/Cc,QAD+C,SAC/CA,QAD+C;;AAEvDb,MAAAA,UAAU,CAACa,QAAD,CAAV;AACD,KAHD;;AAKA,IAAA,KAAI,CAACV,MAAL,CAAYY,UAAZ,CAAuBH,IAAvB,CAA4B,WAA5B,EAAyC,YAAM;AAC7CjB,MAAAA,KAAK,CAACqB,IAAN,CAAW,WAAX,EAAwBC,IAAxB,CAA6B,UAACC,QAAD,EAAc;AACzC,YAAML,QAAQ,GAAGK,QAAQ,CAACC,IAAT,CAAcN,QAA/B;AACAb,QAAAA,UAAU,CAACa,QAAD,CAAV;AACD,OAHD;AAID,KALD;;AAMA,WAAO;AAAA,aAAM,KAAI,CAACV,MAAL,CAAYiB,UAAZ,EAAN;AAAA,KAAP;AACD,GAnBQ,EAmBN,EAnBM,CAAT;;AAqBA,MAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,GAAD,EAAS;AAC3B,QAAMC,KAAK,GAAGD,GAAG,CAACE,MAAJ,CAAWD,KAAzB;;AAEA,QAAID,GAAG,CAACG,OAAJ,KAAgB,EAAhB,IAAsB,CAACH,GAAG,CAACI,QAA/B,EAAyC;AAAA,UAC/BzB,OAD+B,GACpB,KAAI,CAAC0B,KADe,CAC/B1B,MAD+B;AAEvC,UAAMF,QAAO,GAAG;AAAEE,QAAAA,MAAM,EAANA,OAAF;AAAUF,QAAAA,OAAO,EAAEwB,KAAnB;AAA0BK,QAAAA,SAAS,EAAE,CAAC,IAAIC,IAAJ;AAAtC,OAAhB;AAEAP,MAAAA,GAAG,CAACE,MAAJ,CAAWD,KAAX,GAAmB,EAAnB;AACArB,MAAAA,SAAS,CAAC,IAAD,EAAO;AAAA,eAAMP,KAAK,CAACqB,IAAN,CAAW,UAAX,EAAuBjB,QAAvB,CAAN;AAAA,OAAP,CAAT;AACD;AACF,GAVD;;AAYA,MAAM+B,MAAM,GAAG,CACb,WADa,EAEb,MAFa,EAGb,OAHa,EAIb,MAJa,EAKb,UALa,EAMb,OANa,EAOb,OAPa,EAQb,OARa,EASb,MATa,EAUb,KAVa,EAWb,SAXa,EAYb,MAZa,EAab,SAba,EAcb,WAda,EAeb,SAfa,CAAf;AAkBA,MAAMC,eAAe,GAAG;AACtBC,IAAAA,QAAQ,EAAE,QADY;AAEtBC,IAAAA,MAAM,EAAE,EAFc;AAGtBC,IAAAA,YAAY,EAAE,EAHQ;AAItBC,IAAAA,MAAM,EAAE;AAJc,GAAxB;;AAOA,MAAMC,aAAa,GAAG,SAAhBA,aAAgB,CAACnC,MAAD;AAAA,WAAY,UAACqB,GAAD;AAAA,aAASpB,SAAS,CAACD,MAAD,CAAlB;AAAA,KAAZ;AAAA,GAAtB;;AAEA,MAAMoC,YAAY,GAAG,SAAfA,YAAe,CAACC,KAAD,EAAW;AAC9B,QAAMC,QAAQ,GAAG,EAAjB;AACA,QAAIC,CAAC,GAAG,CAAR;AAEAF,IAAAA,KAAK,GAAGG,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYD,IAAI,CAACE,GAAL,CAASL,KAAT,EAAgBR,MAAM,CAACc,MAAvB,CAAZ,CAAR;;AAEA,WAAOJ,CAAC,GAAGF,KAAX,EAAkB;AAChB,UAAMO,KAAK,GAAGJ,IAAI,CAACK,KAAL,CAAWL,IAAI,CAACM,MAAL,KAAgBjB,MAAM,CAACc,MAAlC,CAAd;AACA,UAAIL,QAAQ,CAACS,QAAT,CAAkBH,KAAlB,CAAJ,EAA8B;AAC9B,QAAEL,CAAF,IAAOD,QAAQ,CAACzB,IAAT,CAAc+B,KAAd,CAAP;AACD;;AAED,WAAON,QAAQ,CAACU,GAAT,CAAa,UAACJ,KAAD,EAAW;AAC7B,UAAM5C,MAAM,GAAG6B,MAAM,CAACe,KAAD,CAArB;AACA,UAAMK,SAAS,GACb,uGADF;AAGA,aACE;AACE,QAAA,GAAG,EAAEL,KADP;AAEE,QAAA,SAAS,EAAEK,SAFb;AAGE,QAAA,KAAK,EAAEnB,eAHT;AAIE,QAAA,KAAK,EAAE9B,MAJT;AAKE,QAAA,OAAO,EAAEmC,aAAa,CAACnC,MAAD;AALxB,SAOGA,MAPH,CADF;AAWD,KAhBM,CAAP;AAiBD,GA7BD;;AA8BA,SACE,4BACE;AACE,IAAA,SAAS,EAAC,iGADZ;AAEE,IAAA,KAAK,EAAE;AAAEgC,MAAAA,MAAM,EAAE;AAAV;AAFT,KAIE;AAAI,IAAA,SAAS,EAAC;AAAd,gBAJF,EAKE;AACE,aAAM,qCADR;AAEE,IAAA,KAAK,EAAE;AAAED,MAAAA,QAAQ,EAAE;AAAZ;AAFT,KAIG,KAAI,CAACnB,QAAL,CAAc+B,MAJjB,CALF,CADF,EAcE;AACE,IAAA,SAAS,EAAC,qGADZ;AAEE,IAAA,KAAK,EAAE;AAAEX,MAAAA,MAAM,EAAE;AAAV;AAFT,KAIG,CAAChC,MAAD,IACC;AACE,IAAA,SAAS,EAAC,gBADZ;AAEE,IAAA,KAAK,EAAE;AAAE+B,MAAAA,QAAQ,EAAE,QAAZ;AAAsBmB,MAAAA,UAAU,EAAE;AAAlC;AAFT,2BALJ,EAaE;AAAK,IAAA,SAAS,EAAC;AAAf,KACGlD,MAAM,GACL;AACE,IAAA,SAAS,EAAC,qGADZ;AAEE,IAAA,KAAK,EAAE8B,eAFT;AAGE,IAAA,KAAK,EAAE9B;AAHT,KAKGA,MALH,CADK,GASLoC,YAAY,CAAC,CAAD,CAVhB,CAbF,EA2BGpC,MAAM,IACL;AACE,IAAA,SAAS,EAAC,wBADZ;AAEE,IAAA,OAAO,EAAEoB,WAFX;AAGE,IAAA,WAAW,EAAC,gBAHd;AAIE,IAAA,KAAK,EAAE;AAAE+B,MAAAA,MAAM,EAAE;AAAV;AAJT,IA5BJ,CAdF,CADF;AAqDD,CAnJD;;GAAMvD,c;;KAAAA,c;AAqJN,eAAeA,cAAf","sourcesContent":["import React, { Component, useState, useEffect } from 'react';\nimport axios from 'axios';\nimport Pusher from 'pusher-js';\n\nconst CommentsWidget = (props) => {\n  const [comment, setComment] = useState([]);\n  const [person, setPerson] = useState(null);\n\n  useEffect(() => {\n    this.pusher = new Pusher(process.env.PUSHER_APP_KEY, {\n      cluster: process.env.PUSHER_APP_CLUSTER,\n      encrypted: true,\n    });\n    this.channel = this.pusher.subscribe('post-comments');\n\n    this.channel.bind('new-comment', ({ comment = null }) => {\n      const { comments } = comment && comments.push(comment);\n      setComment(comments);\n    });\n\n    this.pusher.connection.bind('connected', () => {\n      axios.post('/comments').then((response) => {\n        const comments = response.data.comments;\n        setComment(comments);\n      });\n    });\n    return () => this.pusher.disconnect();\n  }, []);\n\n  const handleKeyUp = (evt) => {\n    const value = evt.target.value;\n\n    if (evt.keyCode === 13 && !evt.shiftKey) {\n      const { person } = this.state;\n      const comment = { person, comment: value, timestamp: +new Date() };\n\n      evt.target.value = '';\n      setPerson(null, () => axios.post('/comment', comment));\n    }\n  };\n\n  const people = [\n    'Stephanie',\n    'John',\n    'Steve',\n    'Anna',\n    'Margaret',\n    'Felix',\n    'Chris',\n    'Jamie',\n    'Rose',\n    'Bob',\n    'Vanessa',\n    '9lad',\n    'Bridget',\n    'Sebastian',\n    'Richard',\n  ];\n\n  const nameBadgeStyles = {\n    fontSize: '0.8rem',\n    height: 40,\n    borderRadius: 20,\n    cursor: 'pointer',\n  };\n\n  const choosePersona = (person) => (evt) => setPerson(person);\n\n  const randomPeople = (count) => {\n    const selected = [];\n    let i = 0;\n\n    count = Math.max(0, Math.min(count, people.length));\n\n    while (i < count) {\n      const index = Math.floor(Math.random() * people.length);\n      if (selected.includes(index)) continue;\n      ++i && selected.push(index);\n    }\n\n    return selected.map((index) => {\n      const person = people[index];\n      const className =\n        'd-block d-flex align-items-center text-center text-white bg-secondary font-weight-bold py-2 px-4 mr-3';\n\n      return (\n        <span\n          key={index}\n          className={className}\n          style={nameBadgeStyles}\n          title={person}\n          onClick={choosePersona(person)}\n        >\n          {person}\n        </span>\n      );\n    });\n  };\n  return (\n    <>\n      <div\n        className='border-bottom border-gray w-100 px-2 d-flex align-items-center bg-white justify-content-between'\n        style={{ height: 90 }}\n      >\n        <h2 className='text-dark mb-0 mx-4'>Comments</h2>\n        <span\n          class='badge badge-pill badge-primary mx-4'\n          style={{ fontSize: '1.2rem' }}\n        >\n          {this.comments.length}\n        </span>\n      </div>\n\n      <div\n        className='border-top border-gray w-100 px-4 d-flex flex-wrap align-items-center align-content-center bg-light'\n        style={{ height: 160 }}\n      >\n        {!person && (\n          <span\n            className='text-dark py-2'\n            style={{ fontSize: '1.5rem', fontWeight: 500 }}\n          >\n            Choose your Persona\n          </span>\n        )}\n\n        <div className='w-100 py-2 pb-3 d-flex justify-content-start'>\n          {person ? (\n            <span\n              className='d-block d-flex align-items-center text-center text-white bg-primary font-weight-bold py-2 px-4 mr-3'\n              style={nameBadgeStyles}\n              title={person}\n            >\n              {person}\n            </span>\n          ) : (\n            randomPeople(4)\n          )}\n        </div>\n\n        {person && (\n          <textarea\n            className='form-control px-3 py-2'\n            onKeyUp={handleKeyUp}\n            placeholder='Make a comment'\n            style={{ resize: 'none' }}\n          ></textarea>\n        )}\n      </div>\n    </>\n  );\n};\n\nexport default CommentsWidget;\n"]},"metadata":{},"sourceType":"module"}